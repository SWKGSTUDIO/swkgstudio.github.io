<!DOCTYPE html>
<html>
<head>
    <title>Minecraft Block</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Baloo+Bhaijaan&display=swap">


    <style>
        html {
            overflow: hidden;
        }

        body {
            background: linear-gradient(to bottom, #151C0B, #13100E);
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        #minecraftContainer {
            position: relative;
            z-index: 5;
        }

        .minecraftBlock {
            width: 300px;
            height: 300px;
            background-image: url('assets/img/minecraft/blocks/block_earth.webp');
            background-size: cover;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            overflow: hidden;
            transform-origin: center bottom;
        }

        .pickaxe {
            width: 200px;
            height: 200px;
            background-image: url('assets/img/minecraft/pickaxe.png');
            background-size: cover;
            position: absolute;
            animation: swing 0.3s ease-in-out;
            pointer-events: none;
            z-index: 10;
            transform: translateY(-500px);
        }

        .crack {
            position: absolute;
            width: 300px;
            height: 300px;
            background-size: cover;
            pointer-events: none;
            display: none;
        }

        .shard {
            position: absolute;
            width: 80px;
            height: 80px;
            background-size: cover;
            pointer-events: none;
            z-index: 999;

        }

        @keyframes swing {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(100deg);
            }
        }
    </style>
</head>

<body>

    <div id="minecraftContainer"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>

    <script type="module">

        var blockCounter = 0;
        var currentCrackIndex = 0;
        var isMining = false;
        var currentBlockIndex = 0;


var crackImages = [
    'assets/img/minecraft/d1.png',
    'assets/img/minecraft/d2.png',
    'assets/img/minecraft/d3.png',
    'assets/img/minecraft/d4.png',
    'assets/img/minecraft/d5.png',
    'assets/img/minecraft/d6.png',
    'assets/img/minecraft/d6.png',
    'assets/img/minecraft/d6.png',
    'assets/img/minecraft/d6.png',
    'assets/img/minecraft/d6.png'
];

var shardsImages = [
    'assets/img/minecraft/BlueGem.png',
    'assets/img/minecraft/GreenGem.webp',
    'assets/img/minecraft/RedGem.png',
    'assets/img/minecraft/Coin.webp',
    'assets/img/minecraft/BlueGem.png',
    'assets/img/minecraft/GreenGem.webp',
    'assets/img/minecraft/RedGem.png',
    'assets/img/minecraft/Coin.webp',
    'assets/img/minecraft/BlueGem.png',
    'assets/img/minecraft/GreenGem.webp',
    'assets/img/minecraft/RedGem.png',
    'assets/img/minecraft/Coin.webp',
    'assets/img/minecraft/BlueGem.png',
    'assets/img/minecraft/GreenGem.webp',
    'assets/img/minecraft/RedGem.png',
    'assets/img/minecraft/Coin.webp',

    
];


var blocks = [
    'assets/img/minecraft/blocks/block_earth.webp',
    'assets/img/minecraft/blocks/gold.png',
    'assets/img/minecraft/blocks/mush.webp',
    'assets/img/minecraft/blocks/oak.webp',
    // Добавьте сюда остальные изображения блоков
];






// Функция создания нового блока Minecraft
function createMinecraftBlock() {
    if (isMining) {
        return; 
    }

    var minecraftContainer = document.getElementById("minecraftContainer");
    var minecraftBlock = document.createElement("div");
    minecraftBlock.className = "minecraftBlock";
    minecraftBlock.id = "block" + blockCounter;

    // Генерируем случайный индекс для выбора картинки
    var randomBlockIndex = Math.floor(Math.random() * blocks.length);
    minecraftBlock.style.backgroundImage = `url(${blocks[randomBlockIndex]})`;

    minecraftContainer.appendChild(minecraftBlock);

    var cracks = [];
    for (var i = 0; i < 5; i++) {
        var crack = document.createElement("div");
        crack.className = "crack";
        if (i === 0) {
            crack.style.display = "none";
        }
        minecraftBlock.appendChild(crack);
        cracks.push(crack);
    }

    minecraftBlock.addEventListener("click", function (event) {
        if (isMining) {
            return; // Не реагируем на клики, если уже идет добыча
        }

        isMining = true; // Устанавливаем флаг добычи

        var targetBlock = event.currentTarget;
        var offsetX = event.clientX;
        var offsetY = event.clientY;
        mineBlock(targetBlock, offsetX, offsetY, cracks);
    });

    blockCounter++;
}





function createShards(minecraftContainer) {
    const shardCount = shardsImages.length;

    // Получаем размеры окна браузера
    const windowWidth = window.innerWidth;
    const windowHeight = window.innerHeight;

    // Минимальная и максимальная скорость осколков
    const minSpeed = 1;
    const maxSpeed = 5;

    for (let i = 0; i < shardCount; i++) {
        let shard = document.createElement("div");
        shard.className = "shard";
        shard.style.backgroundImage = `url(${shardsImages[i]})`;
        minecraftContainer.appendChild(shard);

        // Генерируем случайные начальные координаты осколков в центре страницы
        const randomInitialX = windowWidth / 2;
        const randomInitialY = windowHeight / 2;

        // Генерируем случайную скорость для осколка
        const speed = Math.random() * (maxSpeed - minSpeed) + minSpeed;

        // Генерируем случайный угол направления осколка
        const angle = Math.random() * Math.PI * 2;

        // Вычисляем компоненты скорости по x и y
        const velocityX = Math.cos(angle) * speed;
        const velocityY = Math.sin(angle) * speed;

        shard.style.cursor = "pointer";

        // Используем библиотеку anime.js для анимации перемещения осколков
        anime({
            targets: shard,
            translateX: [0, velocityX * 50], // Изменяем положение по X
            translateY: [0, velocityY * 50], // Изменяем положение по Y
            duration: 100, // Анимация разлета
            easing: "linear",
            complete: function () {
                // После разлета, меняем анимацию на падение за пределы страницы
                anime({
                    targets: shard,
                    translateY: [velocityY * 100, windowHeight + 100], // Падение за пределы страницы
                    duration: 6000, // Длительность падения
                    easing: "linear",
                    complete: function () {
                        shard.remove();
                    },
                });
            },
        });
    }
}







// Функция добычи блока
function mineBlock(targetBlock, clientX, clientY, cracks) {
    var pickaxe = document.createElement("div");
    pickaxe.className = "pickaxe";
    var minecraftContainer = document.getElementById("minecraftContainer");
    minecraftContainer.appendChild(pickaxe);

    var blockRect = targetBlock.getBoundingClientRect();
    var blockLeft = blockRect.left + window.scrollX;
    var blockTop = blockRect.top + window.scrollY;

    var offsetX = clientX - blockLeft - targetBlock.offsetWidth / 2;
    var offsetY = clientY - blockTop - targetBlock.offsetHeight / 2;

    pickaxe.style.left = offsetX + "px";
    pickaxe.style.top = offsetY + "px";

    cracks[currentCrackIndex].style.display = "none";

    currentCrackIndex = (currentCrackIndex + 1) % cracks.length;

    cracks[currentCrackIndex].style.display = "block";

    anime({
        targets: pickaxe,
        rotate: -20,
        duration: 500,
        easing: "easeInOutQuad",
        complete: function () {
            pickaxe.remove();
        },
    });

    // Добавляем анимацию shake к minecraftContainer
    anime({
        targets: minecraftContainer,
        translateX: [
            { value: -2, duration: 50 },
            { value: 2, duration: 50 },
            { value: -2, duration: 50 },
            { value: 2, duration: 50 },
            { value: 0, duration: 50 }
        ],
        translateY: [
            { value: -2, duration: 50 },
            { value: 2, duration: 50 },
            { value: -2, duration: 50 },
            { value: 2, duration: 50 },
            { value: 0, duration: 50 }
        ],
        complete: function () {
            if (currentCrackIndex === cracks.length - 1) {
                // Удаляем блок после завершения анимации трещин
                targetBlock.remove();
                cracks[currentCrackIndex].style.display = "none";
                
                createShards(minecraftContainer);
                

                // Подождите 1 секунду, а затем создайте новый блок и разлетающиеся осколки
                setTimeout(function () {
                    isMining = false; // Сбрасываем флаг добычи
                    createMinecraftBlock();
                }, 1000);
            } else {
                isMining = false; // Сбрасываем флаг добычи, чтобы можно было кликнуть снова
            }
        },
    });
}

// Инициализация
createMinecraftBlock();

    </script>
    
    
</body>
</html>
